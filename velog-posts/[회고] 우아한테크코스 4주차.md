<h2 id="📃4주차-미션">📃4주차 미션</h2>
<p><a href="https://github.com/gmltn9233/java-convenience-store-7-gmltn9233">4주차 미션</a>은 편의점이었다.
이전 주차 미션들과는 다르게 입출력부터 복잡했고, 세부적인 요구사항들이 늘어났다.</p>
<h2 id="🌧문제-해결-과정">🌧문제 해결 과정</h2>
<h3 id="1-객체-나누기">1. 객체 나누기</h3>
<p>먼저 <strong>객체를 나누는것</strong> 부터 시작했다.
3주차 미션을 진행하며 객체를 조금 더 세세하게 분리해 볼 걸 하는 후회가 있었기에, 가장 최소 단위의 객체로 분리하려고 시도하였다.</p>
<p>먼저 도메인을 크게 <code>order(주문)</code>, <code>promotion(할인)</code>, <code>store(편의점)</code> 으로 나누어 객체를 설계하였다.</p>
<p>각 <strong>상품</strong>마다 일반 재고, 프로모션 재고, 프로모션 등 상품으로 연결되는 로직이 많았기에, <strong><code>product(상품)</code>을 key로</strong> 가지는 <code>map</code> 구조를 설계하였다.</p>
<p>편의점은 <code>Product</code>를 기반으로 <code>Inventory</code>를 가지고 있으며 <code>Inventory</code>는 상품에 해당하는 수량정보 만을 관리한다. </p>
<h3 id="2-프로모션">2. 프로모션?</h3>
<p><code>Product</code> 마다 <strong>프로모션</strong>을 가질 수 있으며 <strong>프로모션의 내용은 프로모션 마다 다르다.</strong></p>
<p>그래서 프로모션을 적용하는 부분에서 2주차에서 배웠던 <strong>전략패턴</strong>을 사용하기로 했다.</p>
<p>예시에서는 <strong>상품 a 개를 사면 b개를 더주는 방식의 증정품 프로모션</strong>이 나왔지만 전략패턴을 도입하면서 더하기 방식 이외에도 퍼센트로 할인해주는 등의 프로모션 전략을 도입하고 싶은 욕심이 들었기 때문이다.</p>
<p>그렇게 전략패턴을 도입하여 <code>PromotionStrategy</code> 인터페이스를 만든 후 구현체인 <code>PlusPromotion</code>을 주입받아서 프로모션을 진행하는 방식을 도입하였다.</p>
<p>하지만 기존의 증정품 방식에서 프로모션을 적용할때 증정품의 개수를 return 하는 방식에 반해 할인 프로모션 방식은 return한다면 어떤 것을 return 해야 할지 고민이였다.</p>
<p>또 이렇게 패턴마다 return되는 형식이 상이하다면 이후 프로모션과 관련된 로직에서도 수정이 필요했기에 이러한 방식은 옳지 않다고 생각하였기에 우선은 기존 예시인 증정품 프로모션이라도 잘 해결해보자고 마음먹었다.</p>
<h3 id="3-객체-흐름">3. 객체 흐름</h3>
<p><img alt="" src="https://velog.velcdn.com/images/gmltn9233/post/8dbed79d-6e82-43e1-92b7-2251bfd98f0c/image.png" /></p>
<p>객체 흐름은 아래와 같다. </p>
<ol>
<li>주문 요청은 <code>view</code> 와 <code>controller</code> 를 통해 <code>dto</code>로 <code>service</code> 에 전달된다. </li>
<li><code>service</code>는 <code>dto</code>를 통해 <strong>주문 객체</strong>를 만들어낸다.</li>
<li><strong>주문 객체</strong>를 편의점에 넘겨주어 주문을 진행한다.</li>
<li>주문이 완료되면 편의점은 <strong>영수증 객체</strong>를 만들어서 다시 <code>service</code>에 전달한다.</li>
<li><code>service</code>는 <strong>영수증 객체</strong>로 <code>response dto</code>를 만들어 <code>controller</code>에 전달한다.</li>
<li><code>dto</code>의 정보를 이용해서 <code>view</code> 에서 <strong>영수증 정보</strong>를 사용자에게 전달한다.</li>
</ol>
<h2 id="😥아쉬웠던-점">😥아쉬웠던 점</h2>
<h3 id="1-객체지향">1. 객체지향</h3>
<p>최소한 작은 객체로 만들어야겠어!! 하고 객체를 분리하다 보니 오히려 각 객체들의 행동이 오히려 부자연스러워 진것 같다.</p>
<h4 id="getter와-setter의-남발">getter와 setter의 남발</h4>
<p>객체를 분리하였지만 실상 기능 구현에는 분리한 객체들의 통합적인 움직임이 필요해서 결국은 객체가 행동하게 하는것이 아니라 단순히 데이터 저장소에 가깝게 이용했던것 같다.</p>
<h4 id="디미터의-법칙">디미터의 법칙</h4>
<p>객체간의 결합도가 높아 <code>.</code> 을 연속적으로 사용하면서 사용하는 등 객체 분리의 이유를 잃어버린것 같다.</p>
<h4 id="그럼에도-불구하고-너무-긴-메서드들">그럼에도 불구하고 너무 긴 메서드들</h4>
<p>객체를 분리하면서 위와 같이 단점들을 만들었지만 정작 필요한 메서드들은 너무 많아 <code>StroreInventory</code> 클래스에는 18개의 메서드를 가지는 등 분리가 필요할때는 분리하지 못했다.</p>
<h3 id="2-계층간-역할">2. 계층간 역할</h3>
<p>현재 요청이 들어오면 <strong>영수증 객체</strong> 가 생성되는데, 멤버십 재고 부족으로 인한 정가 구입 안내나 프로모션 상품 무료 추가 안내의 경우 생성하는 과정에서 <code>input</code>을 받아야 하기에 <code>비지니스 로직 안에서 다시 입력을 받는 상황이 발생</code>했다.</p>
<h3 id="3-테스트-코드">3. 테스트 코드</h3>
<p>객체간의 높은 결합도로 인해 전체 로직에 대한 통합 테스트 밖에 작성하지 못했다.</p>
<h2 id="🏁4주차를-마치며">🏁4주차를 마치며</h2>
<p>이번 주차는 가장 많은 좌절을 겪었던 미션인 것 같다. 3주차까지 미션을 진행하면서 디자인 패턴, 확장성, 객체지향에 대해 어느정도 감을 잡았다고 생각이 들었다. 하지만 4주차 미션은 욕심을 들여 매일 밤을 새가면서, 설계를 계속 뒤엎어가며 미션을 진행하였음에도 기능구현만으로도 벅차 나 자신이 봐도 이해하기 어려운 뒤죽박죽 스파게티 코드가 작성이 되었다. 이러한 실패의 경험을 발판삼아 부족함을 인지하고 더 성장해 나가야겠다.  </p>
<h2 id="🍀프리코스를-끝내며">🍀프리코스를 끝내며</h2>
<p>4주간의 프리코스 기간 동안 미션을 제출하기 위해 밤도 많이 샜고, 기존에 내가 알고 있던 지식들을 정리하고 새로운 지식을 학습하는 과정을 겪었다. 쉽지 않은 과정이었지만 뿌듯하기도 하고, 내가 더 보충해 나가야할 영역이 뚜렷하게 보이는 것 같아 더 성장하고 싶다는 생각이 든다.</p>
<p>미션을 진행하며 생긴 고민들을 리뷰와 토론글을 통해 지원자들과 토론하면서 조금 더 깊이 있는 고민을 할 수 있었고 지원자들과 의견을 나누면서 함께 성장하는 과정을 통해 협업과 나눔에 대한 가치를 다시한번 느낄 수 있었다. 프리코스 이후 결과가 어떻게 될지는 모르겠지만, 프리코스를 통해 내가 한 단계 더 성장했다는 것은 확실히 말할 수 있을 것 같다. 
4주차 동안 고생 많으셨습니다. 모두들. 나도.🖐</p>